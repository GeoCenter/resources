---
layout: post
title: Heatmaps in Excel
---
### Description
[Heatmaps](https://en.wikipedia.org/wiki/Heat_map) are an efficient way to represent large amounts of information structured in a table or matrix. Cell values are mapped to colors to create a visual representation of the underlying data. 

### Encoding
**x**: categorical

**y**: categorical

**color** (fill): numeric

### How does the data need to be formatted?  
A table or matrix is necessary to create a heatmap. A format similar to the table below is ideal.
![image1]({{ site.baseurl }}/img/DataFormatHeatmap.png "Optional title")

### Excel version
Excel 2010 for Windows

### Instructions
1. __Color data__: Highlight the inner portion of the matrix or table you wish to visualize. From the ```Home``` tab on the ribbon, click on ```Conditional Formatting". From the drop down menu, select ```Color Scales``` and pic any of the diverging color scales. 
  ![image1]({{ site.baseurl }}/img/01_ConditionalFormatting.png "Conditional Formatting"). 
  You now have a matrix that has been conditionally formatted. This is a good start, but we need to clean up the workbook to get a clean looking heatmap.
  
2. __Format color__: Highlight the inner portion of the matrix and click on the ```Conditional Formatting``` button again. From the rop down menu, move your mouse all the way to bottom and select ```Manage Rules...```. This will launch the Conditional Formatting Rules Manager. When used properly, the manager can help you filter and format your data based on logical rules and conditions. At this point though, we are going to focus on changing the color of our heatmap. 
 ![image1]({{ site.baseurl }}/img/02_ConditionalFormattingManager.png "Conditional Formatting Rules Manager"). 
  Double click on the color ramp next to the Graded Color Scale text. This will launch the Edit Formatting Rule Menu.  
  ![image1]({{ site.baseurl }}/img/03_FormattingRules.png "Formatting Rules"). 
  To change the colors of your heatmap, simply click on the color bar under each rule.  We use a value = 0 for the midpoint because are data are centered around 0 and thus divergent. If you have continuous data, it may make more sense to use a sequential color ramp, with midpoint as the mean or median. To access the Red, Green, Blue options, click on any of the color fields and select the More Colors... option. This will launch a new pop-up with two tabs, Standard and Custom. Click on the Custom tabe to bring up the RGB editor
  ![image1]({{ site.baseurl }}/img/04_FormattingRulesColors.png "Diverging Palette"). 
  For our example, we use the following settings:
    * Minimum --> Lowest Value --> Red = 215, Green = 24, Blue = 43
    * Midpoint --> Number --> Value = 0 --> Red = 255, Green = 255, Blue = 191
    * Maximum --> Highest Value --> Red = 69, Green = 117, Blue = 180 . 
  
3. 
